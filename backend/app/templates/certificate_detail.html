<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç ‚Ññ{{ cert.id }}</title>
    <link rel="stylesheet" href="/static/style.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
</head>

<body>
    <header class="bx-topbar" aria-label="–ü–∞–Ω–µ–ª—å Bitrix24">
        <div class="bx-left">
            <button class="bx-burger" type="button" aria-label="–ú–µ–Ω—é">‚ò∞</button>
            <a class="bx-brand" href="/">–ë–∏—Ç—Ä–∏–∫—Å<span class="bx-brand-24">24</span></a>
        </div>

        <div class="bx-search" role="search">
            <span class="bx-search-icon">üîç</span>
            <input class="bx-search-input" type="text" placeholder="–∏—Å–∫–∞—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –¥–æ–∫—É–º–µ–Ω—Ç..." />
        </div>

        <div class="bx-center">
            <button class="bx-chat" type="button" aria-label="–ß–∞—Ç—ã"><span>üí¨</span><span>–ß–∞—Ç—ã</span></button>
            <div class="bx-clock" data-bx-clock>12:53</div>
        </div>

        <div class="bx-right">
            <div class="bx-work">–†–ê–ë–û–¢–ê–Æ</div>
            <button class="bx-btn bx-btn--ghost" type="button">–ö—É–ø–∏—Ç—å —Ç–∞—Ä–∏—Ñ</button>
            <button class="bx-btn bx-btn--primary" type="button">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å +</button>

            <div class="profile">
                <button class="bx-user-btn" id="profileBtn" type="button" aria-haspopup="menu" aria-expanded="false">
                    <span class="bx-user-name">{{ user.full_name }}</span>
                    <span class="bx-user-avatar">{{ user.initials }}</span>
                </button>
                <div class="profile-menu" id="profileMenu" role="menu" aria-label="–ú–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è">
                    <div class="profile-menu-header">
                        <div class="avatar avatar--sm">{{ user.initials }}</div>
                        <div class="profile-menu-meta">
                            <div class="profile-menu-name">{{ user.full_name }}</div>
                            <div class="profile-menu-role">{{ user.role_label }}</div>
                        </div>
                    </div>
                    <a class="profile-menu-item" href="/profile">–ü—Ä–æ—Ñ–∏–ª—å</a>
                    <a class="profile-menu-item" href="/logout">–í—ã–π—Ç–∏</a>
                </div>
            </div>
        </div>
    </header>

    <div class="app">
        <aside class="sidebar">
            <div class="logo">
                <span class="logo-icon">A</span>
                <span>–ö–æ–º–ø–∞–Ω–∏—è</span>
            </div>
            <nav class="nav">
                <a class="nav-item" href="/">–ñ–∏–≤–∞—è –ª–µ–Ω—Ç–∞</a>
                <a class="nav-item" href="#">–°–æ—Ç—Ä—É–¥–Ω–∏–∫–∏</a>
                <a class="nav-item" href="#">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞</a>
                <a class="nav-item active" href="/certification">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</a>
                <a class="nav-item" href="#">–î–∏—Å–∫</a>
                <a class="nav-item" href="#">–ó–∞–¥–∞—á–∏ –∏ –ø—Ä–æ–µ–∫—Ç—ã</a>
                <a class="nav-item" href="#">HR</a>
                <a class="nav-item" href="#">Face ID</a>
                <a class="nav-item" href="#">–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π</a>
                <a class="nav-item" href="#">–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–π —Ü–µ–Ω—Ç—Ä</a>
                <a class="nav-item" href="#">FAQ</a>
                <a class="nav-item" href="#">–î–æ–∫—É–º–µ–Ω—Ç—ã –∏ –ø—Ä–∏–∫–∞–∑—ã</a>
                <a class="nav-item" href="#">–õ–æ–∫–∞–ª—å–Ω—ã–µ –Ω–æ—Ä–º–∞—Ç–∏–≤—ã</a>
                <a class="nav-item" href="#">–ö–∞—Ä—Ç–∞ –æ—Ñ–∏—Å–∞</a>
                <a class="nav-item" href="#">–ò–º–ø–æ—Ä—Ç –∏ —ç–∫—Å–ø–æ—Ä—Ç</a>
                <a class="nav-item" href="#">Web-–∫–∞—Ñ–µ</a>
                <a class="nav-item" href="#">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
            </nav>
        </aside>

        <main class="content">
            <div class="feed-header feed-header--between">
                <div class="header-stack">
                    <div class="breadcrumbs">
                        <a href="/certification">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è</a>
                        <span class="breadcrumbs-sep">/</span>
                        <span>–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç ‚Ññ{{ cert.id }}</span>
                    </div>
                    <h1>{{ cert.name }}</h1>
                    <div class="cert-meta">
                        <span>{{ cert.snapshot_full_name }}</span>
                        {% if cert.snapshot_position %}
                        <span class="dot">‚Ä¢</span><span>{{ cert.snapshot_position }}</span>
                        {% endif %}
                        {% if cert.snapshot_module %}
                        <span class="dot">‚Ä¢</span><span>{{ cert.snapshot_module }}</span>
                        {% endif %}
                    </div>
                </div>

                <div class="btn-row">
                    <a class="btn" href="/certification">–ù–∞–∑–∞–¥</a>
                    <a class="btn" href="/api/certificates/{{ cert.id }}/image" target="_blank" rel="noopener">–û—Ç–∫—Ä—ã—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</a>
                    <a class="btn btn--primary" href="/api/certificates/{{ cert.id }}/pdf">–°–∫–∞—á–∞—Ç—å PDF</a>
                    {% if can_exam %}
                    <button class="btn btn--primary" type="button" id="detailExamBtn">–ü–æ—Å—Ç–∞–≤–∏—Ç—å –æ—Ü–µ–Ω–∫—É</button>
                    {% endif %}
                    {% if can_hr %}
                        {% if cert.workflow_status != 'revoked' %}
                        <button class="btn btn--danger" type="button" id="detailRevokeBtn">–û—Ç–æ–∑–≤–∞—Ç—å</button>
                        {% else %}
                        <button class="btn btn--outline" type="button" id="detailUnrevokeBtn">–ü—Ä–∏–Ω—è—Ç—å</button>
                        {% endif %}
                        <button class="btn btn--outline" type="button" id="detailEditBtn">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn btn--danger" type="button" id="detailDeleteBtn">–£–¥–∞–ª–∏—Ç—å</button>
                    {% endif %}

                </div>
            </div>

            <div id="certDetailRoot"
                data-cert-id="{{ cert.id }}"
                data-share-url="{{ share_url }}"
                data-can-exam="{% if can_exam %}1{% else %}0{% endif %}"
                data-can-hr="{% if can_hr %}1{% else %}0{% endif %}"
                data-cert-type="{{ cert.cert_type }}"
                data-topic="{{ cert.topic or '' }}"
                data-name="{{ cert.name }}"
                data-issued-at="{{ cert.issued_at }}"
                data-expires-at="{{ cert.expires_at or '' }}"></div>

            <div class="detail-grid">
                <section class="detail-card">
                    <div class="detail-card-title">–ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä</div>
                    <div class="cert-preview">
                        <img class="cert-preview-img" src="/api/certificates/{{ cert.id }}/image" alt="–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç" />
                    </div>
                </section>

                <section class="detail-card">
                    <div class="detail-card-title">–î–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</div>

                    <div class="kv">
                        <div class="kv-row"><div class="kv-k">–¢–∏–ø</div><div class="kv-v">{% if cert.cert_type == 'internal' %}–í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π{% else %}–í–Ω–µ—à–Ω–∏–π{% endif %}</div></div>
                        {% if cert.cert_type == 'internal' %}
                        <div class="kv-row"><div class="kv-k">–ü—Ä–æ—Ñ–∏–ª—å</div><div class="kv-v">{{ cert.topic or '‚Äî' }}</div></div>
                        {% endif %}
                        <div class="kv-row"><div class="kv-k">–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏</div><div class="kv-v">{{ cert.issued_at }}</div></div>
                        <div class="kv-row"><div class="kv-k">–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ</div><div class="kv-v">{{ cert.expires_at or '–ë–µ—Å—Å—Ä–æ—á–Ω–æ' }}</div></div>
                        <div class="kv-row"><div class="kv-k">–°—Ç–∞—Ç—É—Å</div><div class="kv-v">{{ cert.status_label }}</div></div>
                    </div>
                    <div class="qr-wrap open" style="margin-top:12px;">
                        <img class="qr-img" src="/api/certificates/{{ cert.id }}/qr" alt="QR" />
                        <div class="qr-meta">
                            <div>–°—Å—ã–ª–∫–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞</div>
                            <a class="qr-link" href="{{ share_url }}" target="_blank" rel="noopener">{{ share_url }}</a>
                            <button class="btn btn--outline btn--sm" type="button" id="copyShareLinkBtn">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
                        </div>
                    </div>


                    {% if cert.cert_type == 'internal' and cert.workflow_status == 'pending_exam' %}
                    <div class="detail-callout">
                        <div class="detail-callout-title">–≠–∫–∑–∞–º–µ–Ω</div>
                        <div>–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–∞—Ç—å —ç–∫–∑–∞–º–µ–Ω —É <b>{{ cert.required_examiner_name or '‚Äî' }}</b>.</div>
                    </div>
                    {% endif %}

                    {% if cert.cert_type == 'internal' and cert.workflow_status == 'passed' %}
                    <div class="detail-callout">
                        <div class="detail-callout-title">–≠–∫–∑–∞–º–µ–Ω —Å–¥–∞–Ω</div>
                        <div>–û—Ü–µ–Ω–∫–∞: <b>{{ cert.exam_grade or '‚Äî' }}</b>{% if cert.exam_date %} ({{ cert.exam_date }}){% endif %}</div>
                    </div>
                    {% endif %}

                    {% if cert.workflow_status == 'revoked' %}
                    <div class="detail-callout detail-callout--danger">
                        <div class="detail-callout-title">–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç–æ–∑–≤–∞–Ω</div>
                        <div>HR: <b>{{ cert.revoked_by_name or '‚Äî' }}</b></div>
                        <div>–ü—Ä–∏—á–∏–Ω–∞: <b>{{ cert.revoked_reason or '‚Äî' }}</b></div>
                    </div>
                    {% endif %}

                </section>
            </div>

            <!-- –ú–æ–¥–∞–ª–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ -->
            <div class="modal" id="examModal" aria-hidden="true">
                <div class="modal-backdrop" data-close="1"></div>
                <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="examModalTitle">
                    <div class="modal-header">
                        <h2 id="examModalTitle">–†–µ–∑—É–ª—å—Ç–∞—Ç —ç–∫–∑–∞–º–µ–Ω–∞</h2>
                        <button class="modal-close" type="button" data-close="1">‚úï</button>
                    </div>
                    <form id="examForm" class="modal-form">
                        <input type="hidden" name="cert_id" />
                        <div class="form-row">
                            <label class="form-field">
                                <span>–û—Ü–µ–Ω–∫–∞</span>
                                <select name="exam_grade" required>
                                    <option value="Hard">Hard</option>
                                    <option value="Standart">Standart</option>
                                    <option value="Light">Light</option>
                                    <option value="–ù–µ —Å–¥–∞–Ω">–ù–µ —Å–¥–∞–Ω</option>
                                </select>
                            </label>
                            <label class="form-field">
                                <span>–î–∞—Ç–∞ —Å–¥–∞—á–∏</span>
                                <input name="exam_date" type="date" required />
                            </label>
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn--primary" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button class="btn" type="button" data-close="1">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                        <div class="form-error" id="examFormError" aria-live="polite"></div>
                    </form>
                </div>
            </div>

            <div class="modal" id="revokeModal" aria-hidden="true">
                <div class="modal-backdrop" data-close="1"></div>
                <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="revokeModalTitle">
                    <div class="modal-header">
                        <h2 id="revokeModalTitle">–û—Ç–æ–∑–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</h2>
                        <button class="modal-close" type="button" data-close="1">‚úï</button>
                    </div>
                    <form id="revokeForm" class="modal-form">
                        <input type="hidden" name="cert_id" />
                        <label class="form-field">
                            <span>–ü—Ä–∏—á–∏–Ω–∞ –æ—Ç–∑—ã–≤–∞</span>
                            <textarea name="reason" rows="4" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã / –∏—Å—Ç—ë–∫ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç / –æ—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è" required></textarea>
                        </label>
                        <div class="modal-actions">
                            <button class="btn btn--danger" type="submit">–û—Ç–æ–∑–≤–∞—Ç—å</button>
                            <button class="btn" type="button" data-close="1">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                        <div class="form-error" id="revokeFormError" aria-live="polite"></div>
                    </form>
                </div>
            </div>

            <div class="modal" id="editModal" aria-hidden="true">
                <div class="modal-backdrop" data-close="1"></div>
                <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="editModalTitle">
                    <div class="modal-header">
                        <h2 id="editModalTitle">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç</h2>
                        <button class="modal-close" type="button" data-close="1">‚úï</button>
                    </div>
                    <form id="editForm" class="modal-form">
                        <label class="form-field">
                            <span>–ù–∞–∑–≤–∞–Ω–∏–µ</span>
                            <input name="name" type="text" required />
                        </label>
                        <label class="form-field" id="editTopicField">
                            <span>–ü—Ä–æ—Ñ–∏–ª—å —Å–¥–∞—á–∏</span>
                            <select name="topic">
                                <option value="–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞">–ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞</option>
                                <option value="–û–∫–∞–∑–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –ø–æ–º–æ—â–∏">–û–∫–∞–∑–∞–Ω–∏–µ –ø–µ—Ä–≤–æ–π –ø–æ–º–æ—â–∏</option>
                            </select>
                        </label>
                        <div class="form-row">
                            <label class="form-field">
                                <span>–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏</span>
                                <input name="issued_at" type="date" required />
                            </label>
                            <label class="form-field" id="editExpiresField">
                                <span>–î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –¥–æ</span>
                                <input name="expires_at" type="date" />
                            </label>
                        </div>
                        <div class="radio-row" style="margin-top:6px;">
                            <label class="radio-pill">
                                <input type="checkbox" name="is_perpetual" id="isPerpetualEdit" checked />
                                <span>–ë–µ—Å—Å—Ä–æ—á–Ω—ã–π</span>
                            </label>
                        </div>
                        <div class="modal-actions">
                            <button class="btn btn--primary" type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button class="btn" type="button" data-close="1">–û—Ç–º–µ–Ω–∞</button>
                        </div>
                        <div class="form-error" id="editFormError" aria-live="polite"></div>
                    </form>
                </div>
            </div>


        </main>
    </div>

    <footer class="footer">
        <p>by –º–æ–¥—É–ª—å "–¶–∏—Ñ—Ä–æ–≤–∏–∑–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–Ω—ã—Ö –∑–∞–¥–∞—á" –£–≠</p>
    </footer>

    <script src="/static/app.js"></script>
</body>

</html>
